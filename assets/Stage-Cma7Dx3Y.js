import{_ as X,o as f,c as v,a as s,n as H,t as h,e as z,f as A,F as S,g as x,d as T,u as B,h as D,v as F,i as K,j as ee,k as I,l as te,m as re}from"./index-CtqxFC-g.js";class j{constructor(e){this.short=e,this.props={short:e};let t=O.find(i=>i.short==e);if(t){this.props=t,this.member=t.member;let i=se.find(m=>m.member==t.member);i&&(this.year=i.year,this.unit=i.unit),this.cost=t.cost,this.teCostDelta=0}}copy(){let e=new j(this.short);return e.cost=this.cost,e.teCostDelta=this.teCostDelta,e}getMain(e){var t;return(t=this.props)!=null&&t.main?typeof this.props.main=="function"?this.props.main(e):this.props.main:""}getCost(e=!1){let t=this.cost;return e&&(t+=this.teCostDelta),t>=1?t:1}isReshuffle(e){var t;return(t=this.props)!=null&&t.reshuffle?typeof this.props.reshuffle=="function"?this.props.reshuffle(e):this.props.reshuffle:!1}onSkill(e){var t;(t=this.props)!=null&&t.skill&&(typeof this.props.skill=="function"?e.trigger(this.props.skill(e)):e.trigger(this.props.skill))}afterSkill(e){var t;(t=this.props)!=null&&t.afterSkill&&this.props.afterSkill(e)}onDraw(e){var t;this.teCostDelta=0,(t=this.props)!=null&&t.draw&&(typeof this.props.draw=="function"?e.trigger(this.props.draw(e,this)):e.trigger(this.props.draw))}onCross(e,t){var i;(i=this.props)!=null&&i.cross&&this.props.cross(e,t,this)}matchAttrs(e){return Object.keys(e).every(t=>e[t]==null?!0:e[t]==this[t])}calcSubtractAp(e){let t=0;if(e!=null&&e.length)for(let i of e)this.matchAttrs({...i,cost:void 0})&&(t+=i.cost);return t}}const se=[{member:3,short:"kz",year:102,unit:"srb"},{member:4,short:"tz",year:102,unit:"drk"},{member:6,short:"mg",year:102,unit:"mrp"},{member:1,short:"kh",year:103,unit:"srb"},{member:2,short:"sy",year:103,unit:"drk"},{member:5,short:"rr",year:103,unit:"mrp"},{member:7,short:"gn",year:104,unit:"srb"},{member:8,short:"sz",year:104,unit:"drk"},{member:9,short:"hm",year:104,unit:"mrp"}],O=[{short:"圣夜吟",member:7,cost:8,main:"dress",reshuffle:!0,skill:{cards:["圣夜👗","圣夜👗","圣夜👗","圣夜👗","圣夜👗"]}},{short:"圣夜👗",member:"dress",cost:3,main:"reshuffle",reshuffle:!0,once:!0,skill:{mental:1,voltage:1}},{short:"pa吟",member:7,cost:4,main:"dress",skill:{cards:["pa吟👗","pa吟👗"]}},{short:"pa吟👗",member:"dress",cost:2,main:"ap",once:!0},{short:"lttf铃",member:8,cost:9,main:"voltage",skill:{voltage:1,mental:-1},drawFilters:[{member:9}]},{short:"上升姬芽",member:9,cost:3,main(r){return r!=null&&r.ignition?"reshuffle":"mental"},reshuffle:r=>r==null?void 0:r.ignition,skill:{mental:1,protect:1},afterSkill(r){r.ignition&&(r.timesDict[this.short]==null?r.timesDict[this.short]=0:r.timesDict[this.short]++,r.timesDict[this.short]>=3&&(r.ignition=!1,r.timesDict[this.short]=void 0),r.getAllCards().forEach(e=>{e.unit=="mrp"&&(e.cost-=3)}))},cross(r,e){if(!r.ignition){let t=e.getMain(r);(t=="mental"||t=="protect")&&(r.ignition=!0)}}},{short:"pa姬芽",member:9,cost:4,main:"reshuffle",reshuffle:!0,skill:{protect:1}},{short:"织姬花帆",member:1,cost:4,main:"reshuffle",reshuffle:!0,skill:{mental:1}},{short:"音击花帆",member:1,cost:9,main:"heart",reshuffle:!0,yamaReshuffle:!0,skill:{heart:3},draw:{heart:1,mental:1}},{short:"lttf沙耶",member:2,cost:5,main:"voltage",skill:{voltage:1},drawFilters:[{member:6}]},{short:"沏茶瑠璃",member:5,cost:4,main:"reshuffle",reshuffle:!0,skill:{voltage:1},draw:{heart:1}},{short:"蛋糕瑠璃",member:5,cost:4,main:"reshuffle",reshuffle:!0,skill:{heart:1},draw:{heart:1}},{short:"花结梢",member:3,cost:13,main:"reshuffle",reshuffle:!0,drawFilters:[{unit:"srb"},{member:"dress"},{unit:"srb"},{member:"dress"},{unit:"srb"},{member:"dress"},{unit:"srb"},{member:"dress"}],cross(r,e,t){e.unit=="srb"&&(r.trigger({heart:1}),t.teCostDelta-=3)},afterSkill(r){r.getAllCards().forEach(e=>{(e.unit=="srb"||e.member=="dress")&&(e.cost-=3)})}},{short:"kol梢",member:3,cost:9,main:"mental",skill:{mental:1,heart:1},draw:{"ap-":[{member:6,cost:-9}]},cross(r,e){e.member==6&&r.trigger({protect:1,heart:1})}},{short:"自由缀",member:4,cost:2,main:"mental",skill:{mental:1,heart:1},draw:r=>{let e={};return r.mental&&(e={heart:1}),e}},{short:"kol缀",member:4,cost:3,main:"voltage",skill:{voltage:1,heart:1},draw:{"ap-":[{member:3,cost:-3},{member:6,cost:-3}]},cross(r,e){e.member==6&&r.trigger({voltage:1,heart:1})}},{short:"hsct慈",member:6,cost:4,main:"reshuffle",reshuffle:!0},{short:"kol慈",member:6,cost:39,main:"heart",skill:{heart:2,cards:["💎"]},cross(r,e,t){(e.member==1||e.member==2||e.member==3||e.member==4||e.member==5||e.member==7||e.member==8||e.member==9)&&(t.teCostDelta-=3)}},{short:"💎",member:"jewelry",cost:1,main:"ap-",once:!0,skill:{"ap-":[{cost:-1}]},draw:{heart:1,voltage:1,protect:1}},{short:"舞会缀",member:4,cost:2,main:"voltage",skill:{voltage:1}},{short:"舞会沙耶",member:2,cost:2,main:"love+"},{short:"银河缀",member:4,cost:2,main:"voltage",skill:{voltage:1,heart:1},afterSkill(r){r.sp=="tz2"&&r.trigger({ap:5})}},{short:"银河慈",member:6,cost:5,main:"reshuffle",reshuffle:!0,skill:{mental:2,protect:1},afterSkill(r){r.sp=="mg2"&&r.trigger({ap:20})}},{short:"讴歌梢",member:3,cost:3,main:"love+",draw:{heart:1}},{short:"ritm梢",member:3,cost:2,main:"voltage",skill:{voltage:1},draw:{mental:1}},{short:"秋色梢",member:3,cost:6,main:"love+",draw:{mental:1}},{short:"自由梢",member:3,cost:2,main:"protect",skill:{protect:1},draw:r=>{let e={};return r.mental&&(e={protect:1}),e}},{short:"教师梢",member:3,cost:2,main:"heart",skill:{heart:1,mental:-1},draw:{mental:1}},{short:"ss缀",member:4,cost:3,main:"heart",skill:{heart:1},draw:{voltage:1}},{short:"雨伞缀",member:4,cost:5,main:"love+",draw:{heart:1}},{short:"花火缀",member:4,cost:3,main:"voltage",skill:{voltage:1},draw:{voltage:1}},{short:"秋色缀",member:4,cost:6,main:"heart",skill:r=>{let e={};return r.mental?e={heart:3}:e={heart:2},e},draw:{mental:1}},{short:"抱花缀",member:4,cost:4,main:"voltage",skill:{voltage:1},draw:{voltage:1}},{short:"音击缀",member:4,cost:9,main:"voltage",skill:{voltage:1,heart:3},draw:{voltage:1,protect:1}},{short:"蛋糕慈",member:6,cost:4,main:"mental",skill:{mental:1},draw:{mental:1,protect:1}},{short:"舞会慈",member:6,cost:3,main:"love+",yamaUse:!0,skill:{mental:-1},draw:{mental:1}},{short:"圣诞慈",member:6,cost:4,main:"mental",skill:{mental:3},draw:{mental:1}},{short:"抱花慈",member:6,cost:4,main:"protect",skill:{protect:1},draw:{protect:1}},{short:"ritm花帆",member:1,cost:1,main:"heart",skill:{heart:1},draw:{mental:1}},{short:"讴歌花帆",member:1,cost:3,main:"mental",skill:{mental:1},draw:{voltage:1}},{short:"雨伞花帆",member:1,cost:3,main:"voltage",skill:{voltage:1},draw:{mental:1}},{short:"自由花帆",member:1,cost:2,main:"voltage",skill:{voltage:1,heart:1},draw:r=>{let e={};return r.mental&&(e={voltage:1}),e}},{short:"快乐花帆",member:1,cost:2,main:"mental",skill:{mental:1,voltage:1},draw:{mental:1,heart:1}},{short:"雨伞沙耶",member:2,cost:4,main:"mental",skill:{mental:1},draw:{voltage:1}},{short:"tc沙耶",member:2,cost:3,main:"love+",skill:{mental:-1},draw:{voltage:1}},{short:"圣诞沙耶",member:2,cost:4,main:"voltage",skill:{voltage:1,heart:2},draw:{voltage:1}},{short:"db瑠璃",member:5,cost:4,main:"reshuffle",reshuffle:!0,skill:{voltage:1},draw:{voltage:1}},{short:"rod瑠璃",member:5,cost:4,main:"reshuffle",reshuffle:!0,skill:{mental:1},draw:{mental:1}},{short:"白昼瑠璃",member:5,cost:3,main:"reshuffle",reshuffle:!0,skill:{mental:-1},draw:{heart:1}},{short:"ritm吟",member:7,cost:5,main:"dress",skill:{cards:["ritm👗1","ritm👗2","ritm👗3"]},draw:{protect:1}},{short:"ritm👗1",member:"dress",cost:1,main:"heart",once:!0,skill:{heart:1}},{short:"ritm👗2",member:"dress",cost:1,main:"voltage",once:!0,skill:{voltage:1}},{short:"ritm👗3",member:"dress",cost:1,main:"teMax",once:!0},{short:"af缀",member:4,cost:9,main:"voltage",skill:{voltage:1,heart:9,ap:-20},afterSkill(r){r.sp=="tz2"&&r.trigger({ap:20})}},{short:"af慈",member:6,cost:9,main:"protect",skill:{protect:1,heart:9,ap:-20},afterSkill(r){r.sp=="tz2"&&r.trigger({ap:3})}}];let Z=class _{constructor(e){this.score=0,this.te=[],this.sute=[],this.yama=e,this.mental=!0,this.protect=!1,this.apMax=20,this.ignition=!1,this.timesDict={},this.cardTimesDict={apSkip:0},this.timesCount=0,this.cardsCount=0,this.sp="",this.effect="",this.teMax=8,this.ap=8,this.apSpeed=2.5,this.drawHeartCount=0,this.jewelryCountTarget=0,this.testResults=[]}getAllCards(){return[...this.te,...this.sute,...this.yama]}getDrawYama(){return this.yama.length?this.yama:this.sute}start(){this.sp=="kz2"&&(this.ap=1/0);for(let e=0;e<this.teMax;e++){let t=Math.floor(Math.random()*this.yama.length),i=this.yama.splice(t,1)[0];this.te.push(i)}this.testAllCards()}draw(e,t){this.yama.length||(this.yama=[...this.sute],this.sute=[],this.effect=="kj1a"&&this.yama.forEach(d=>{d.getMain(this)=="reshuffle"&&d.cost++}));let i;t?(i=this.yama.filter(d=>d.matchAttrs(t)),i.length||(i=this.yama)):i=this.yama;let m=Math.floor(Math.random()*i.length),a=i[m];this.yama.splice(this.yama.indexOf(a),1),this.te[e]=a,a.onDraw(this)}autoAp(){this.sp!="kz2"&&this.addAp(this.apSpeed)}useCard(e){var m,a,d,u,b,w,g;if(e==null){this.cardTimesDict.apSkip++,this.autoAp(),this.timesCount++;return}let t=this.te[e];this.cardTimesDict[t.short]||(this.cardTimesDict[t.short]=0),this.cardTimesDict[t.short]++;let i=t.isReshuffle(this);t.onSkill(this);for(let n of this.te)n.onCross(this,t);if(this.sp=="sy"&&this.score++,i){for(let n in this.te)n!=e&&this.sute.push(this.te[n]);(m=t.props)!=null&&m.yamaReshuffle&&this.yama.push(...this.sute.splice(0));for(let n=0;n<this.teMax;n++)this.draw(n,(d=(a=t.props)==null?void 0:a.drawFilters)==null?void 0:d[n])}else this.draw(e,(b=(u=t.props)==null?void 0:u.drawFilters)==null?void 0:b[0]);if((w=t.props)!=null&&w.once||((g=t.props)!=null&&g.yamaUse?this.yama.push(t):this.sute.push(t)),this.sp!="kz2"&&(this.addAp(-t.getCost(!0)),this.autoAp()),t.cost=t.props.cost,t.afterSkill(this),this.timesCount++,this.cardsCount++,this.effect=="kj1b"&&this.cardsCount%5==0){this.sute.push(...this.te.splice(0));for(let n=0;n<this.teMax;n++)this.draw(n)}this.effect=="st1a"&&this.cardsCount%6==0&&this.getAllCards().forEach(n=>n.cost++),!this.protect&&this.sp!="mg2"&&(this.mental=!1),this.testAllCards()}calcTestDrawHeartCount(){let e=0,t=this.getAllCards(),i=t.filter(m=>m.short=="💎").length;if(i<this.jewelryCountTarget)for(let m=0;m<this.jewelryCountTarget-i;m++)t.push(new j("💎"));return t.forEach(m=>{var d,u,b,w;let a;(d=m.props)!=null&&d.draw&&(typeof((u=m.props)==null?void 0:u.draw)=="function"?a=(b=m.props)==null?void 0:b.draw(this):a=(w=m.props)==null?void 0:w.draw),e+=(a==null?void 0:a.heart)||0,this.sp=="tz"&&(e+=(a==null?void 0:a.voltage)||0),this.sp=="mg2"&&(e+=((a==null?void 0:a.mental)||0)+((a==null?void 0:a.protect)||0))}),this.drawHeartCount=e,e}testCard(e,t){var w,g,n,E,U,V,q,$,P,c,l,o;let i=new _([]);for(let p of this.te)i.te.push(p.copy());for(let p of this.sute)i.sute.push(p.copy());for(let p of this.yama)i.yama.push(p.copy());i.mental=this.mental,i.protect=this.protect,i.ap=this.ap,i.apMax=this.apMax,i.apSpeed=this.apSpeed,i.ignition=this.ignition,i.timesDict=this.timesDict,i.sp=this.sp,i.jewelryCountTarget=this.jewelryCountTarget;let m,a;if(t&&(m=i.te[e].getCost(!0),i.te[e]=t,a=i.te[e].getCost(!0),a>i.apMax))return 0;let d=i.te[e],u=d.isReshuffle(i);d.onSkill(i);for(let p of i.te)p.onCross(i,d);i.calcTestDrawHeartCount();let b=i.score;if(u&&(b+=i.drawHeartCount*8/(i.getAllCards().length+(((n=(g=(w=d.props)==null?void 0:w.skill)==null?void 0:g.cards)==null?void 0:n.length)??0))),((U=(E=d.props)==null?void 0:E.drawFilters)==null?void 0:U.length)==1&&!t){let p=(V=d.props)==null?void 0:V.drawFilters[0],k=i.getDrawYama().filter(y=>Object.keys(p).every(C=>y[C]==p[C]));k.forEach(y=>b+=i.testCard(e,y)/k.length)}return(P=($=(q=d.props)==null?void 0:q.skill)==null?void 0:$.cards)!=null&&P.length&&(b/=((o=(l=(c=d.props)==null?void 0:c.skill)==null?void 0:l.cards)==null?void 0:o.length)+1),d.short=="上升姬芽"&&(b*=3/4),t?b/(m+a)*m:b}testAllCards(){this.testResults=this.te.map((e,t)=>this.testCard(t))}trigger(e){this.addAp(e.ap),this.addHeart(e.heart),this.addVoltage(e.voltage),this.addMental(e.mental),this.addProtect(e.protect),this.subtractAp(e["ap-"]),this.addCard(e.cards)}addHeart(e){e&&(this.score+=e)}addVoltage(e){e&&this.sp=="tz"&&(this.score+=e,this.addAp(1*e))}addMental(e){e&&(e>0&&this.sp=="mg2"&&(this.score+=e,this.addAp(1*e)),e>0?this.mental=!0:e<0&&this.sp!="mg2"&&(this.mental=!1))}addProtect(e){e&&(this.sp=="mg2"&&(this.score+=e,this.addAp(2*e)),this.protect=!0)}subtractAp(e){if(e!=null&&e.length)for(let t of this.getAllCards())t.cost+=t.calcSubtractAp(e)}addCard(e){if(e!=null&&e.length)for(let t of e)this.yama.push(new j(t))}addAp(e){if(e){let t=this.ap+e;t>this.apMax&&(t=this.apMax),t<0&&(t=0),this.ap=Number(t.toFixed(2))}}};const le={class:"cost"},ie={key:0,class:"close"},ae={key:1,class:"test"},oe={key:2,class:"time"},ne={__name:"Card",props:{card:{type:j},stage:{type:Z},te:{default:!1},close:{default:!1},pointerEvents:{default:"auto"}},setup(r){const e=r,t={heart:"rgb(204,39,39)","love+":"rgb(174,141,24)",voltage:"rgb(174,141,24)",mental:"rgb(48,124,24)",reshuffle:"rgb(134,82,195)",teMax:"rgb(134,82,195)",protect:"rgb(48,124,24)",dress:"rgb(134,82,195)",ap:"rgb(174,141,24)","ap-":"rgb(134,82,195)","":"transparent"},i={1:"#f8b500",2:"#5383c3",3:"#68be8d",4:"#ba2636",5:"#e7609e",6:"#c8c2c6",7:"#a2d7dd",8:"#fad764",9:"#9d8de2"};return(m,a)=>{var d,u;return f(),v("div",{class:"card",style:H({pointerEvents:r.te&&e.card.getCost(r.te)>e.stage.ap?"none":e.pointerEvents})},[s("div",{class:"background",style:H({backgroundColor:i[e.card.member]?`${i[e.card.member]}`:"transparent"})},null,4),s("div",{style:H({fontWeight:e.card.isReshuffle(e.stage)?"bold":"",fontStyle:e.card.isReshuffle(e.stage)?"italic":""})},h(e.card.short),5),s("div",le,h(e.card.getCost(r.te)),1),s("div",{class:"main",style:H({backgroundColor:t[e.card.getMain(e.stage)]})},null,4),e.close?(f(),v("div",ie,"×")):z("",!0),e.te?(f(),v("div",ae,h(Number(e.stage.testResults[e.stage.te.indexOf(e.card)].toFixed(2))),1)):z("",!0),((d=e.stage)==null?void 0:d.timesDict[e.card.short])!=null?(f(),v("div",oe,h((u=e.stage)==null?void 0:u.timesDict[e.card.short]),1)):z("",!0)],4)}}},N=X(ne,[["__scopeId","data-v-6e2c0724"]]);function R(r){let e=[];for(let t=0;t<r.te.length;t++)r.te[t].getCost(!0)<=r.ap&&e.push(t);return e}function G(r,e){let t=e.map(m=>r.testResults[m]),i=Math.max(...t);return e.filter((m,a)=>t[a]==i)}function Y(r,e){let t=r.te.map((a,d)=>r.testResults[d]/r.te[d].getCost(!0)),i=e.map(a=>t[a]),m=Math.max(...i);if(m==0&&Math.max(...t)>0){let a=Math.min(...e.map(d=>r.te[d].getCost(!0)));return a<=r.apSpeed?e.filter(d=>r.te[d].getCost(!0)==a):[]}else return e.filter((a,d)=>i[d]==m)}function ue(r,e){let t=e.map(m=>{let a=r.te[m],d=0;return r.getAllCards().forEach(u=>{var b,w,g,n;(w=(b=u.props)==null?void 0:b.draw)!=null&&w["ap-"]&&(d+=a.calcSubtractAp((n=(g=u.props)==null?void 0:g.draw)==null?void 0:n["ap-"]))}),d}),i=Math.min(...t);return e.filter((m,a)=>t[a]==i)}function W(r,e){let t=e.filter(i=>{var m,a;return(a=(m=r.te[i].props)==null?void 0:m.drawFilters)==null?void 0:a.length});return t.length?t:e}function me(r,e){let t=e.filter(i=>{var m,a;return!(((a=(m=r.te[i].props)==null?void 0:m.skill)==null?void 0:a.mental)<0)});return t.length?t:e}function J(r,e){let t=e.filter(i=>r.te[i].member=="dress");return t.length?t:e}function Q(r,e,t){if(r.getAllCards().filter(a=>a.member=="jewelry").length>e)return t;let m=t.filter(a=>r.te[a].member!="jewelry");return m.length?m:t}function L(r,e=8,t){let i,m;if(t==null&&(t=r.strategy??(r.sp=="mg2"||r.sp=="tz2"||r.sp=="kz2"?"score":"cost"),r.ap+r.apSpeed>=r.apMax&&(t="score")),!r.ignition&&r.te.find(a=>a.short=="上升姬芽")&&r.te.find(a=>(a.getMain(r)=="mental"||a.getMain(r)=="protect")&&a.short!="上升姬芽")&&(t=="score"?i=G(r,R(r).filter(a=>{let d=r.te[a];return(d.getMain(r)=="mental"||d.getMain(r)=="protect")&&d.short!="上升姬芽"}))[0]:i=Y(r,R(r).filter(a=>{let d=r.te[a];return(d.getMain(r)=="mental"||d.getMain(r)=="protect")&&d.short!="上升姬芽"}))[0]),i==null&&(m=r.te.findIndex(a=>a.short=="kol慈"),m>=0&&r.getAllCards().filter(a=>a.member=="jewelry").length<e&&r.te[m].getCost(!0)<(t=="score"?r.ap:r.ap+Math.min(0,r.apSpeed-4))&&(i=m)),i==null&&(m=r.te.findIndex(a=>a.member=="jewelry"&&a.getCost(!0)==2),m>=0&&r.getAllCards().filter(a=>a.member=="jewelry").length>e&&(i=m)),i==null&&(t=="score"?i=W(r,Q(r,e,G(r,J(r,R(r)))))[0]:i=ue(r,W(r,Q(r,e,Y(r,me(r,J(r,R(r)))))))[0]),R(r).length&&i==null)debugger;return i}window.strategyPlay=L;const de={class:"grid"},he=["open"],fe={class:"grid"},pe={style:{"font-size":"small"}},ce=["disabled"],ve=["disabled"],be=["disabled"],ge=["disabled"],ke=["disabled"],ye=["disabled"],we=["disabled"],Ce=["disabled"],Se=["disabled"],Te=["disabled"],Ae=["disabled"],De={style:{"text-align":"right"}},Me={class:"flex-between"},je={class:"flex-between"},xe={class:"flex-between"},Fe={class:"grid"},Ee={class:"grid"},Pe={class:"grid"},ze={colspan:"6"},Ve={colspan:"2"},$e={colspan:"2"},Ie={colspan:"2"},Ne={colspan:"2"},Re={colspan:"2"},Ue={colspan:"2"},qe=["onClick"],He={colspan:"2",style:{"text-align":"center"}},Ke={__name:"Stage",setup(r){const e=A(!1),t=A(!1),i=A([]),m=A(!1),a=A(),d=A(),u=A({qc:140,sh:3.3,apSpeed:2.6,sp:"",effect:"",jewelryCountTargetMin:0,jewelryCountTargetMax:20,cardTimes:373,skipTimes:100,strategy:"cost"}),b=A(10),w=O.map(c=>new j(c.short)).sort((c,l)=>typeof c.member=="number"&&typeof l.member=="number"?c.member-l.member:typeof c.member=="number"&&typeof l.member!="number"?-1:typeof c.member!="number"&&typeof l.member=="number"||c.member>l.member?1:c.member<l.member?-1:0),g=A(O.filter(c=>typeof c.member=="number").map(c=>new j(c.short)).slice(0,16)),n=A();window.getStage=()=>n.value;const E=()=>{n.value=new Z([]),n.value.apSpeed=Number(u.value.apSpeed),n.value.sp=u.value.sp,n.value.effect=u.value.effect,n.value.strategy=u.value.strategy,n.value.yama=g.value.map(c=>new j(c.short))};E();const U=()=>{e.value=!1,E()},V=async c=>{var l;if(m.value=!1,e.value=!0,t.value=c,c){i.value.push({deck:g.value.map(o=>o.short).join(", "),formData:{...u.value},dict:{}});for(let o=Number(u.value.jewelryCountTargetMin);o<=Number(u.value.jewelryCountTargetMax)&&e.value;o++){let p=0,k=0,y={apSkip:0};for(let C of g.value)y[C.short]=0;for(let C=0;C<Number(u.value.skipTimes);C++){await q(),E(),n.value.jewelryCountTarget=o,n.value.start();for(let M=0;M<Number(u.value.cardTimes)&&e.value;M++)n.value.useCard(L(n.value,o));if(!e.value)break;p+=n.value.score,k+=(l=n.value.getAllCards().filter(M=>M.member=="jewelry"))==null?void 0:l.length;for(let M in n.value.cardTimesDict)y[M]||(y[M]=0),y[M]+=n.value.cardTimesDict[M]}if(!e.value)break;for(let C in y)y[C]=Number((y[C]/u.value.skipTimes).toFixed(2));i.value.at(-1).dict[o]={score:Number((p/u.value.skipTimes).toFixed(2)),jewelryCount:Number((k/u.value.skipTimes).toFixed(2)),cardTimesDict:y}}e.value=!1}else E(),n.value.jewelryCountTarget=b.value,n.value.start(),P()},q=async c=>new Promise(l=>setTimeout(l,c)),$=A(-1),P=()=>{$.value=L(n.value,b.value)};return(c,l)=>(f(),v("div",null,[!e.value||t.value?(f(),v(S,{key:0},[l[20]||(l[20]=s("h2",null,"DECK",-1)),l[21]||(l[21]=s("hr",null,null,-1)),s("div",de,[(f(!0),v(S,null,x(g.value,(o,p)=>(f(),I(N,{card:o,close:!0,onClick:k=>g.value.splice(p,1),"pointer-events":e.value?"none":"auto"},null,8,["card","onClick","pointer-events"]))),256))]),s("details",{open:m.value},[l[19]||(l[19]=s("summary",null,[T(" CARD "),s("hr")],-1)),s("div",fe,[(f(!0),v(S,null,x(B(w),(o,p)=>(f(),I(N,{card:o,onClick:k=>g.value.push(new(B(j))(o.short)),"pointer-events":e.value?"none":"auto"},null,8,["card","onClick","pointer-events"]))),256))])],8,he)],64)):z("",!0),s("form",null,[l[38]||(l[38]=s("h2",null,"STAGE",-1)),l[39]||(l[39]=s("hr",null,null,-1)),s("div",pe,[l[22]||(l[22]=s("label",{for:"qc"},"曲长: ",-1)),D(s("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.qc=o),type:"text",disabled:e.value,id:"qc"},null,8,ce),[[F,u.value.qc]]),l[23]||(l[23]=T(" s  ")),l[24]||(l[24]=s("label",{for:"qc"},"生化值: ",-1)),D(s("input",{"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.sh=o),type:"text",disabled:e.value,id:"sh"},null,8,ve),[[F,u.value.sh]]),l[25]||(l[25]=T("   ")),s("button",{onClick:l[2]||(l[2]=o=>{u.value.apSpeed=Number((1200/u.value.qc/u.value.sh).toFixed(2)),u.value.cardTimes=Math.floor(u.value.qc*8/3)}),disabled:e.value}," 计算AP回复速度/暂停回数 ",8,be)]),s("div",null,[l[26]||(l[26]=s("label",{for:"ap"},"AP回复速度: ",-1)),D(s("input",{"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.apSpeed=o),type:"text",disabled:e.value,id:"ap"},null,8,ge),[[F,u.value.apSpeed]])]),s("div",null,[l[27]||(l[27]=s("label",{for:"card-time"},"暂停回数: ",-1)),D(s("input",{"onUpdate:modelValue":l[4]||(l[4]=o=>u.value.cardTimes=o),disabled:e.value,type:"number",id:"card-time"},null,8,ke),[[F,u.value.cardTimes]])]),s("div",null,[l[29]||(l[29]=s("label",{for:"sp"},"SP: ",-1)),D(s("select",{"onUpdate:modelValue":l[5]||(l[5]=o=>u.value.sp=o),disabled:e.value,id:"sp",onChange:l[6]||(l[6]=o=>u.value.sp.includes("2")?u.value.strategy="score":u.value.strategy="cost")},l[28]||(l[28]=[ee('<option value="" data-v-493d34e8>--</option><option value="tz" data-v-493d34e8>舞会缀</option><option value="sy" data-v-493d34e8>舞会沙耶</option><option value="tz2" data-v-493d34e8>银河缀</option><option value="mg2" data-v-493d34e8>银河慈</option>',5)]),40,ye),[[K,u.value.sp]])]),s("div",null,[l[31]||(l[31]=s("label",{for:"effect"},"效果: ",-1)),D(s("select",{"onUpdate:modelValue":l[7]||(l[7]=o=>u.value.effect=o),disabled:e.value,id:"effect"},l[30]||(l[30]=[s("option",{value:""},"--",-1),s("option",{value:"st1a"}," (2025年1月公会战A) skill6回使用 deck全card消费AP+1 ",-1),s("option",{value:"kj1a"}," (2025年1月个人战A) 山札切 main效果reshuffle效果deck全card消费AP+1 ",-1),s("option",{value:"kj1b"}," (2025年1月个人战B) skill5回使用 手札全捨 山札手札上限引直 ",-1)]),8,we),[[K,u.value.effect]])]),s("div",null,[l[33]||(l[33]=s("label",{for:"strategy"},"策略: ",-1)),D(s("select",{"onUpdate:modelValue":l[8]||(l[8]=o=>u.value.strategy=o),disabled:e.value,id:"strategy"},l[32]||(l[32]=[s("option",{value:"cost"},"pt/AP优先",-1),s("option",{value:"score"},"pt优先",-1)]),8,Ce),[[K,u.value.strategy]])]),s("div",null,[l[34]||(l[34]=s("label",{for:"jewelry"},"LIVE TARGET💎: ",-1)),D(s("input",{"onUpdate:modelValue":l[9]||(l[9]=o=>b.value=o),type:"number",id:"jewelry",onChange:l[10]||(l[10]=o=>{e.value&&!t.value&&(n.value.jewelryCountTarget=b.value,n.value.testAllCards(),P())})},null,544),[[F,b.value]])]),s("div",null,[l[35]||(l[35]=s("label",{for:"jewelry"},"SKIP TARGET💎: ",-1)),D(s("input",{"onUpdate:modelValue":l[11]||(l[11]=o=>u.value.jewelryCountTargetMin=o),disabled:e.value,type:"number",id:"jewelry"},null,8,Se),[[F,u.value.jewelryCountTargetMin]]),l[36]||(l[36]=T(" ~ ")),D(s("input",{"onUpdate:modelValue":l[12]||(l[12]=o=>u.value.jewelryCountTargetMax=o),disabled:e.value,type:"number",id:"jewelry"},null,8,Te),[[F,u.value.jewelryCountTargetMax]])]),s("div",null,[l[37]||(l[37]=s("label",{for:"skip-time"},"SKIP回数: ",-1)),D(s("input",{"onUpdate:modelValue":l[13]||(l[13]=o=>u.value.skipTimes=o),disabled:e.value,type:"number",id:"skip-time"},null,8,Ae),[[F,u.value.skipTimes]])])]),s("div",De,[e.value?(f(),v("button",{key:0,onClick:U},"RETIRE")):(f(),v(S,{key:1},[i.value.length?(f(),v("button",{key:0,onClick:l[14]||(l[14]=o=>i.value=[])}," CLEAR RESULTS ")):z("",!0),s("button",{onClick:l[15]||(l[15]=o=>V(!0))},"SKIP"),s("button",{onClick:l[16]||(l[16]=o=>V(!1))},"LIVE START")],64))]),e.value&&!t.value?(f(),v(S,{key:1},[s("h2",Me,[s("div",null,h(n.value.score),1),s("div",null,h(n.value.timesCount)+"回",1)]),s("h2",je,[s("div",null,h(n.value.sp=="mg2"?"∞":n.value.mental?"100%":"-%"),1),s("div",null,h(n.value.ignition?"🔥":"🚫")+" "+h(n.value.sp=="kz2"?"∞":n.value.ap),1)]),l[40]||(l[40]=s("div",{style:{"text-align":"right"}},null,-1)),s("h2",xe,[s("div",null,"手札 "+h(n.value.te.length),1),s("button",{onClick:l[17]||(l[17]=o=>{n.value.useCard(void 0),P()})}," AP SKIP ")]),l[41]||(l[41]=s("hr",null,null,-1)),s("div",Fe,[(f(!0),v(S,null,x(n.value.te,(o,p)=>(f(),I(N,{card:o,stage:n.value,te:!0,class:te({highlight:$.value==p}),onClick:k=>{n.value.useCard(p),P()}},null,8,["card","stage","class","onClick"]))),256))]),s("h2",null,"捨札 "+h(n.value.sute.length),1),l[42]||(l[42]=s("hr",null,null,-1)),s("div",Ee,[(f(!0),v(S,null,x(n.value.sute,(o,p)=>(f(),I(N,{card:o,stage:n.value,"pointer-events":"none"},null,8,["card","stage"]))),256))]),s("h2",null,"山札 "+h(n.value.yama.length),1),l[43]||(l[43]=s("hr",null,null,-1)),s("div",Pe,[(f(!0),v(S,null,x(n.value.yama,(o,p)=>(f(),I(N,{card:o,stage:n.value,"pointer-events":"none"},null,8,["card","stage"]))),256))])],64)):(f(),v(S,{key:2},[(f(!0),v(S,null,x(i.value,(o,p)=>(f(),v("table",null,[s("thead",null,[s("tr",null,[s("td",ze,h(o.deck),1)]),s("tr",null,[s("td",Ve,"AP回复速度: "+h(o.formData.apSpeed),1),s("td",$e,"暂停回数: "+h(o.formData.cardTimes),1),s("td",Ie,"SKIP回数: "+h(o.formData.skipTimes),1)]),s("tr",null,[s("td",Ne,"SP: "+h(o.formData.sp),1),s("td",Re,"效果: "+h(o.formData.effect),1),s("td",Ue,"策略: "+h(o.formData.strategy),1)]),l[44]||(l[44]=s("tr",null,[s("td",null,[T("target"),s("br"),T("💎")]),s("td",null,[T("kol慈"),s("br"),T("回数")]),s("td",null,[T("💎"),s("br"),T("回数")]),s("td",null,[T("AP SKIP"),s("br"),T("回数")]),s("td",null,"pt"),s("td",null,"%")],-1))]),s("tbody",null,[(f(!0),v(S,null,x(o.dict,(k,y)=>(f(),v("tr",{style:{cursor:"pointer"},onClick:C=>{d.value={key:y,...k},re(()=>a.value.showModal())}},[s("td",null,h(y),1),s("td",null,h(k.cardTimesDict.kol慈??0),1),s("td",null,h(k.cardTimesDict["💎"]??0),1),s("td",null,h(k.cardTimesDict.apSkip),1),s("td",null,h(k.score),1),s("td",null,h(Number((k.score/Math.max(...Object.values(o.dict).map(C=>C.score))*100).toFixed(2))),1)],8,qe))),256))])]))),256)),d.value?(f(),v("dialog",{key:0,ref_key:"dialog",ref:a},[s("table",null,[s("thead",null,[s("tr",null,[l[45]||(l[45]=s("td",null,"target💎",-1)),s("td",null,h(d.value.key),1)]),s("tr",null,[l[46]||(l[46]=s("td",null,"pt",-1)),s("td",null,h(d.value.score),1)])]),s("tbody",null,[(f(!0),v(S,null,x(d.value.cardTimesDict,(o,p)=>(f(),v("tr",null,[s("td",null,h(p),1),s("td",null,h(o)+"回",1)]))),256))]),s("tfoot",null,[s("tr",null,[s("td",He,[s("button",{onClick:l[18]||(l[18]=o=>d.value=void 0)},"关闭")])])])])],512)):z("",!0)],64))]))}},Le=X(Ke,[["__scopeId","data-v-493d34e8"]]);export{Le as default};
